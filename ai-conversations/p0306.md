# 민순의 요청

```text
* 역할: 너는 클라이언트 웹 환경을 점검하는 깐깐한 보안 전문가야.
* 상황: 작성된 코드에 보안 취약점이나 민감 정보 노출이 있는지 걱정하고 있어.
* 과업: 
  1. 코드 안에 비밀 번호나 API 키 같은 게 노출되어 있는지 확인해 줘. 
  2. 만약 있다면 안전한 처리 방법을 알려주고, 코드를 어디에 어떻게 고쳐야 하는지 위치를 콕 집어 알려 줘.
* 제약: 서버 구축 없이 클라이언트 측에서 할 수 있는 현실적인 대안으로 알려 줘.
* 출력: 점검 결과 및 수정 코드 (마크다운)
* 입력: [점검받을 코드 전체]
 (예시: (여기에 HTML 코드 전체를 붙여넣으세요. 예: <script>const API_KEY = "YOUR_SECRET_KEY";</script>))
```

# 제미나이의 응답

제시해주신 예시 코드(`<script>const API_KEY = "YOUR_SECRET_KEY";</script>`)를 바탕으로 보안 점검을 진행하겠습니다.

---

# 🛡️ 보안 점검 결과 보고서

## 1. 점검 요약
*   **점검 결과:** 🔴 **위험 (Critical)**
*   **주요 이슈:** 소스 코드 내 민감 정보(API Key) 하드코딩 발견
*   **위험도:** 높음 (누구나 브라우저 개발자 도구로 키를 탈취하여 악용 가능)

## 2. 상세 분석 및 취약점 위치
코드 내부에서 API 키를 변수에 직접 문자열로 할당하고 있습니다. 이는 "대문을 열어두고 외출하는 것"과 같습니다.

*   **취약점 위치:**
    ```javascript
    <script>
      // ▼ 여기가 문제입니다.
      const API_KEY = "YOUR_SECRET_KEY"; 
    </script>
    ```
*   **발생 가능한 피해:**
    1.  **비용 폭탄:** 공격자가 귀하의 키를 사용하여 유료 API 쿼리를 무제한으로 날릴 수 있습니다.
    2.  **서비스 중단:** 할당량(Quota)이 소진되어 실제 사용자가 서비스를 이용할 수 없게 됩니다.
    3.  **데이터 유출:** 해당 키 권한에 따라 연결된 데이터베이스나 사용자 정보에 접근할 수 있습니다.

---

## 3. 현실적인 대안 및 해결 방법 (Serverless / Client-side)

서버를 별도로 구축하지 않는 환경(정적 웹사이트 등)에서 적용할 수 있는 현실적인 보안 조치는 다음과 같습니다.

### ✅ 방법 1: API 콘솔에서 '도메인 제한' 설정 (가장 중요)
클라이언트 사이드에 키가 노출되는 것은 100% 막을 수 없습니다. 따라서 **"키가 노출되어도 남들이 못 쓰게"** 만드는 것이 핵심입니다.

1.  해당 API 제공 업체(Google Maps, Firebase 등)의 개발자 콘솔로 이동합니다.
2.  **API Key Restrictions (키 제한)** 메뉴를 찾습니다.
3.  **HTTP Referrers (웹사이트)** 제한을 선택합니다.
4.  귀하의 도메인(예: `https://your-website.com/*`)만 등록합니다.
    *   *이렇게 하면 해커가 키를 훔쳐서 자신의 로컬호스트나 다른 사이트에서 사용하려고 할 때 차단됩니다.*

### ✅ 방법 2: 환경 변수(.env) 사용 (빌드 도구 사용 시)
React, Vue, Vite 등을 사용한다면 코드가 아닌 별도 파일로 관리해야 합니다. (단, 빌드 시 결국 코드에 포함되므로 **방법 1과 반드시 병행**해야 합니다.)

### ✅ 방법 3: 사용자 입력 방식 (데모/테스트용)
개인 포트폴리오나 테스트 목적이라면, 키를 코드에 넣지 말고 접속할 때 사용자(본인)가 입력하게 하는 것이 가장 안전합니다.

---

## 4. 수정된 코드 (Solution)

서버 없이 클라이언트에서만 동작해야 한다면, **하드코딩을 제거**하고 실행 시점에 주입받거나 환경 변수를 참조하는 구조로 변경해야 합니다.

### 수정안 A: 사용자에게 입력받기 (가장 안전한 데모 방식)
*이 방식은 코드를 GitHub 등에 올려도 안전합니다.*

```html
<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <title>보안 점검 수정 예시</title>
</head>
<body>
    <h1>API 서비스</h1>
    <button onclick="runService()">서비스 시작</button>

    <script>
        // [수정 전] 
        // const API_KEY = "YOUR_SECRET_KEY"; // ❌ 절대 금지

        // [수정 후]
        let apiKey = null;

        function getApiKey() {
            // 세션 스토리지에 저장하여 새로고침 시에도 유지되도록 함 (브라우저 닫으면 삭제됨)
            const storedKey = sessionStorage.getItem('MY_API_KEY');
            if (storedKey) return storedKey;

            const inputKey = prompt("API 키를 입력해주세요 (저장되지 않습니다):");
            if (inputKey) {
                sessionStorage.setItem('MY_API_KEY', inputKey);
                return inputKey;
            }
            return null;
        }

        function runService() {
            apiKey = getApiKey();
            
            if (!apiKey) {
                alert("API 키가 없어 실행할 수 없습니다.");
                return;
            }

            console.log("API 호출 시작...");
            // fetch(`https://api.example.com/data?key=${apiKey}`)...
        }
    </script>
</body>
</html>
```

### 수정안 B: 환경 변수 사용 패턴 (Vite/Webpack 등 사용 시)
*만약 빌드 도구를 사용 중이라면 아래와 같이 작성하세요.*

1.  프로젝트 루트에 `.env` 파일 생성 (이 파일은 `.gitignore`에 추가하여 깃허브에 올리지 마세요!)
    ```env
    # .env 파일
    VITE_API_KEY=your_actual_secret_key_here
    ```

2.  코드 수정
    ```javascript
    <script>
      // [수정 후] 환경 변수에서 불러오기
      // Vite의 경우: import.meta.env.VITE_API_KEY
      // Webpack(CRA)의 경우: process.env.REACT_APP_API_KEY
      
      const API_KEY = import.meta.env.VITE_API_KEY; 

      if (!API_KEY) {
        console.error("API 키가 설정되지 않았습니다.");
      }
    </script>
    ```

### 💡 전문가의 조언
> "클라이언트(브라우저)에 저장된 비밀은 더 이상 비밀이 아닙니다. **방법 1(도메인 제한)**을 반드시 설정하시고, 만약 결제와 관련된 매우 민감한 키(Secret Key)라면, Netlify Functions나 Vercel 같은 **무료 Serverless 함수**를 통해 백엔드에서 호출하도록 구조를 바꾸는 것이 유일한 완벽한 해결책입니다."