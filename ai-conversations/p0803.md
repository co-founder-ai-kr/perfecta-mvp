# 민순의 요청

```text
* 역할: 너는 앱스 스크립트와 연동하는 프론트엔드 개발자야.
* 상황: 앱스 스크립트 데이터를 화면에 보여주려는데 로딩 시간이 길어 걱정이야.
* 과업: 
  1. fetch 함수로 데이터를 가져오는 코드를 작성해 줘.
  2. 데이터 로딩 중에 ‘선물을 찾고 있습니다...’ 문구와 애니메이션이 보이게 해 줘.
* 제약: 
  - 주석은 비즈니스 로직(Why) 위주로 달아 줘.
  - HTML 파일 내 script 태그 안에 넣을 코드를 작성해 줘.
* 출력: 자바스크립트 코드 블록
* 입력: [앱스 스크립트 배포 URL 붙여넣기]
```

# 제미나이의 응답

네, 앱스 스크립트(GAS)는 서버가 잠들었다 깨어나는 '콜드 스타트'나 구글 서버 사정에 따라 응답 속도가 느려질 때가 많습니다. 따라서 **사용자가 "멈춘 건가?"라고 오해하지 않도록 명확한 피드백(로딩 화면)을 주는 것**이 핵심 비즈니스 로직입니다.

요청하신 대로 HTML 파일에 바로 붙여넣어 사용할 수 있는 코드를 작성해 드립니다.

```html
<!-- 스타일: 로딩 애니메이션 및 화면 제어 -->
<style>
  /* 로딩 컨테이너: 화면 중앙 정렬 */
  #loading-container {
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    padding: 20px;
    height: 200px; /* 필요에 따라 조절 */
  }

  /* 스피너 애니메이션 정의 */
  .spinner {
    width: 40px;
    height: 40px;
    border: 4px solid #f3f3f3;
    border-top: 4px solid #3498db; /* 포인트 컬러 */
    border-radius: 50%;
    animation: spin 1s linear infinite;
    margin-bottom: 15px;
  }

  @keyframes spin {
    0% { transform: rotate(0deg); }
    100% { transform: rotate(360deg); }
  }

  /* 데이터 컨테이너: 초기에는 숨김 처리 */
  #data-container {
    display: none; /* 데이터 로드 전까지 숨김 */
    padding: 20px;
  }
</style>

<!-- HTML 구조 -->
<div id="app">
  <!-- 1. 로딩 화면 -->
  <div id="loading-container">
    <div class="spinner"></div>
    <p>선물을 찾고 있습니다...</p>
  </div>

  <!-- 2. 데이터 표시 화면 -->
  <div id="data-container">
    <!-- 여기에 데이터가 들어갑니다 -->
  </div>
</div>

<!-- 자바스크립트 로직 -->
<script>
  // [입력] 여기에 배포된 웹 앱 URL을 넣으세요
  const API_URL = '[앱스 스크립트 배포 URL 붙여넣기]';

  /**
   * 앱스 스크립트 데이터를 가져와 화면에 렌더링하는 함수
   */
  async function fetchGiftData() {
    const loadingEl = document.getElementById('loading-container');
    const contentEl = document.getElementById('data-container');

    try {
      // [UX 로직] GAS 응답 지연 시 사용자가 이탈하지 않도록 로딩 상태를 유지
      // 이미 HTML에서 보이고 있지만, 재호출 등을 대비해 명시적으로 표시
      loadingEl.style.display = 'flex';
      contentEl.style.display = 'none';

      // [비즈니스 로직] 비동기 통신 시작
      // 앱스 스크립트의 doGet() 함수를 호출하여 JSON 데이터를 요청함
      const response = await fetch(API_URL);

      // [예외 처리] 네트워크 오류나 서버 오류(404, 500 등)가 발생했는지 확인
      if (!response.ok) {
        throw new Error(`서버 통신 오류: ${response.status}`);
      }

      // [데이터 가공] 응답받은 텍스트를 자바스크립트 객체(JSON)로 변환
      const data = await response.json();

      // [UI 업데이트] 받아온 데이터를 화면에 그리는 로직 (예시)
      // 실제 데이터 구조에 맞춰 수정 필요 (예: data.giftName, data.items 등)
      contentEl.innerHTML = `
        <h2>🎁 선물을 찾았습니다!</h2>
        <pre>${JSON.stringify(data, null, 2)}</pre>
      `;

    } catch (error) {
      // [에러 핸들링] 데이터 로드 실패 시 사용자에게 안내 메시지 노출
      // 콘솔에는 디버깅용 로그를 남기고, 화면에는 친절한 메시지 표시
      console.error('데이터 로딩 실패:', error);
      contentEl.innerHTML = `<p style="color:red;">죄송합니다. 선물을 가져오는 중 문제가 발생했습니다.</p>`;
      
    } finally {
      // [UX 로직] 성공/실패 여부와 관계없이 로딩 애니메이션은 반드시 종료되어야 함
      // 로딩바를 숨기고 결과 화면(또는 에러 메시지)을 노출
      loadingEl.style.display = 'none';
      contentEl.style.display = 'block';
    }
  }

  // 페이지 로드 시 자동으로 데이터 요청 시작
  document.addEventListener('DOMContentLoaded', fetchGiftData);
</script>
```