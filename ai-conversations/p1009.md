# 민순의 요청

```text
* 역할: 너는 이메일 마케팅 전문가이자 앱스 스크립트 개발자야.
* 상황: 신규 회원이 가입했을 때 일일이 메일을 보낼 수가 없어. 잠자는 사이에도 자동으로 환영 인사를 하고 싶어.
* 과업: 
  1. 신규 가입자에게 5일 동안 발송할 '환영 이메일 시퀀스'의 주제와 핵심 내용을 표로 정리해 줘.
  2. 이에 맞게 자동 발송할 수 있도록 앱스 스크립트 코드를 짜 줘.
  3. 이 코드를 구글 시트의 어디에 붙여 넣어야 하는지, 그리고 매일 아침 9시에 자동으로 실행되게 하려면 '트리거(시계 아이콘)'를 어떻게 설정해야 하는지 단계별로 설명해 줘.
* 제약: 
  - 고객이 부담스럽지 않게 친근한 톤으로 설계해 줘.
  - 코드는 복사 가능한 형태로 출력해 줘.
* 입력: [이메일 발송 목적]
 (예시: 신규 가입 환영 및 첫 구매 유도)
```

# 제미나이의 응답

반갑습니다! 이메일 마케팅 전략부터 자동화 시스템 구축까지 한 번에 해결해 드릴게요.

요청하신 **[신규 가입 환영 및 첫 구매 유도]** 목적에 맞춰, 고객이 부담을 느끼지 않으면서도 자연스럽게 지갑을 열 수 있는 **'친근한 넛지(Nudge)'** 전략으로 구성했습니다.

---

### 1. 5일간의 환영 이메일 시퀀스 전략 (Drip Campaign)

고객의 관심도가 가장 높은 가입 직후 5일이 골든타임입니다. 강매하는 느낌이 아니라, **"우리가 당신에게 어떤 도움을 줄 수 있는지"**를 알려주는 여정으로 설계했습니다.

| 발송 시점 | 주제 (Subject) | 핵심 내용 및 목적 (Key Content) |
| :-- | :-- | :-- |
| **Day 1**<br>(가입 당일) | **[환영] OO님, 만나서 반가워요! (🎁웰컴 선물 도착)** | **목적: 즉각적인 보상 및 관계 형성**<br>- 가입 감사 인사와 브랜드의 간략한 소개<br>- **첫 구매 10% 할인 쿠폰** 또는 무료 배송 코드 제공<br>- "부담 없이 둘러보세요"라는 편안한 톤앤매너 |
| **Day 2** | **OO님, 저희가 가장 사랑받는 이유는요...** | **목적: 브랜드 가치 전달 & 흥미 유발**<br>- 베스트셀러 아이템 소개 또는 브랜드 창업 스토리<br>- 우리 서비스/제품을 200% 활용하는 꿀팁<br>- "이런 점이 궁금하지 않으셨나요?" 질문 던지기 |
| **Day 3** | **"솔직히 저도 처음엔 안 믿었어요" (실제 후기)** | **목적: 사회적 증거(Social Proof)를 통한 신뢰 구축**<br>- 기존 고객들의 베스트 리뷰나 성공 사례 공유<br>- 비포/애프터 사진이나 구체적인 사용 후기<br>- 신뢰도를 높여 구매 장벽 낮추기 |
| **Day 4** | **OO님, 웰컴 혜택이 곧 사라져요 ⏰** | **목적: 상기시키기 & 가벼운 긴박감 조성**<br>- Day 1에 드린 쿠폰의 유효기간 알림<br>- 장바구니에 담아두고 잊은 물건은 없는지 체크<br>- "아까운 혜택 놓치지 마세요"라는 걱정 어린 톤 |
| **Day 5** | **마지막 기회! 오늘이 지나면 혜택은 끝나요 👋** | **목적: 최종 구매 유도 (Call To Action)**<br>- 쿠폰 만료 D-Day 알림<br>- 지금 구매해야 하는 명확한 이유 제시<br>- 이후에는 정기 뉴스레터로 찾아뵙겠다는 깔끔한 마무리 |

---

### 2. 구글 앱스 스크립트 코드 (Google Apps Script)

이 코드는 구글 시트에 있는 회원 명단을 읽어, 가입일로부터 며칠이 지났는지 계산하고 그에 맞는 이메일을 자동으로 발송합니다.

**[전제 조건]**
구글 시트의 데이터가 아래 순서대로 입력되어 있어야 합니다.
*   **A열:** 이름
*   **B열:** 이메일 주소
*   **C열:** 가입일 (예: 2023-10-25)

```javascript
function sendWelcomeSequence() {
  // 1. 시트 및 데이터 가져오기
  var sheet = SpreadsheetApp.getActiveSpreadsheet().getActiveSheet();
  var startRow = 2; // 데이터가 시작되는 행 (1행은 헤더)
  var numRows = sheet.getLastRow() - 1; // 데이터가 있는 마지막 행까지
  
  if (numRows < 1) return; // 데이터가 없으면 종료
  
  var dataRange = sheet.getRange(startRow, 1, numRows, 3); // A, B, C열 가져오기
  var data = dataRange.getValues();
  
  // 2. 오늘 날짜 설정 (시간은 0시 0분 0초로 초기화하여 날짜만 비교)
  var today = new Date();
  today.setHours(0, 0, 0, 0);
  
  // 3. 각 회원별로 순회하며 이메일 발송 조건 확인
  for (var i = 0; i < data.length; i++) {
    var row = data[i];
    var name = row[0]; // A열: 이름
    var email = row[1]; // B열: 이메일
    var joinDate = new Date(row[2]); // C열: 가입일
    
    // 날짜 유효성 검사
    if (!email || isNaN(joinDate.getTime())) continue;

    joinDate.setHours(0, 0, 0, 0); // 가입일 시간 초기화
    
    // 가입일로부터 며칠 지났는지 계산 (밀리초 단위 변환)
    var diffTime = today.getTime() - joinDate.getTime();
    var daysPassed = Math.floor(diffTime / (1000 * 60 * 60 * 24));
    
    var subject = "";
    var body = "";
    
    // 4. 경과 일수에 따른 이메일 내용 설정 (HTML 형식)
    switch (daysPassed) {
      case 0: // Day 1 (가입 당일)
        subject = `[환영] ${name}님, 만나서 반가워요! (🎁웰컴 선물 도착)`;
        body = `
          <h2>안녕하세요, ${name}님!</h2>
          <p>저희 가족이 되신 것을 진심으로 환영합니다.</p>
          <p>감사의 마음을 담아 <strong>첫 구매 10% 할인 쿠폰</strong>을 드려요.</p>
          <p style="background-color: #f0f0f0; padding: 10px; text-align: center;"><strong>쿠폰코드: WELCOME10</strong></p>
          <p>지금 바로 사용해 보세요!</p>
        `;
        break;
        
      case 1: // Day 2 (가입 1일 후)
        subject = `${name}님, 저희가 가장 사랑받는 이유는요...`;
        body = `
          <h2>${name}님, 궁금하지 않으셨나요?</h2>
          <p>많은 분들이 저희를 선택해주시는 이유, 바로 '진정성' 때문입니다.</p>
          <p>저희 브랜드가 어떻게 시작되었는지 짧은 이야기를 들려드릴게요...</p>
          <p>(브랜드 스토리 내용)</p>
        `;
        break;
        
      case 2: // Day 3 (가입 2일 후)
        subject = `"솔직히 저도 처음엔 안 믿었어요" (실제 후기)`;
        body = `
          <h2>다른 분들은 어떻게 생각할까요?</h2>
          <p>${name}님과 같은 고민을 하셨던 고객님들의 솔직한 후기를 확인해보세요.</p>
          <p>⭐⭐⭐⭐⭐ "배송도 빠르고 품질이 기대 이상이에요!" - 김OO님</p>
          <p>더 많은 후기가 궁금하시다면 홈페이지를 방문해 주세요.</p>
        `;
        break;
        
      case 3: // Day 4 (가입 3일 후)
        subject = `${name}님, 웰컴 혜택이 곧 사라져요 ⏰`;
        body = `
          <h2>혜택 만료가 얼마 남지 않았어요!</h2>
          <p>가입 선물로 드린 10% 할인 쿠폰, 아직 사용 전이시네요.</p>
          <p>내일이면 혜택이 사라지니, 장바구니에 담아둔 상품이 있다면 지금 확인해 보세요.</p>
        `;
        break;
        
      case 4: // Day 5 (가입 4일 후 - 마지막)
        subject = `마지막 기회! 오늘이 지나면 혜택은 끝나요 👋`;
        body = `
          <h2>${name}님, 정말 마지막 알림입니다.</h2>
          <p>오늘 자정, 웰컴 쿠폰이 만료됩니다.</p>
          <p>망설이고 계셨다면 지금이 가장 좋은 기회입니다.</p>
          <p><a href="https://your-website.com">👉 지금 바로 혜택 받으러 가기</a></p>
        `;
        break;
        
      default:
        // 해당 날짜가 아니면 아무것도 하지 않음
        continue;
    }
    
    // 5. 이메일 발송 실행
    if (subject !== "") {
      try {
        MailApp.sendEmail({
          to: email,
          subject: subject,
          htmlBody: body
        });
        console.log(`${email} 님에게 Day ${daysPassed + 1} 메일 발송 성공`);
      } catch (e) {
        console.error(`${email} 발송 실패: ` + e.toString());
      }
    }
  }
}
```

---

### 3. 설치 및 자동화 설정 가이드 (단계별)

이제 이 코드를 구글 시트에 심고, 매일 아침 9시에 저절로 돌아가게 시계를 맞춰봅시다.

#### 1단계: 코드 붙여넣기
1.  회원 명단이 있는 **구글 스프레드시트**를 엽니다. (A열: 이름, B열: 이메일, C열: 가입일 인지 꼭 확인하세요!)
2.  상단 메뉴에서 **[확장 프로그램]** > **[Apps Script]**를 클릭합니다.
3.  새 창이 열리면 기존에 있는 `function myFunction() {...}` 코드를 싹 지웁니다.
4.  위에서 제가 작성해 드린 **코드를 복사해서 붙여넣기** 합니다.
5.  상단 디스켓 아이콘(💾)을 눌러 **저장**합니다. (프로젝트 이름은 '이메일 자동화' 등으로 지어주세요.)

#### 2단계: 권한 승인 (최초 1회)
1.  코드 입력창 상단의 **[실행]** 버튼을 누릅니다.
2.  *"권한 검토"* 팝업이 뜨면 클릭합니다.
3.  본인의 구글 계정을 선택합니다.
4.  *"Google에서 확인하지 않은 앱"*이라는 경고창이 뜨면 당황하지 말고, 좌측 하단 **[고급]** > **[이메일 자동화(으)로 이동(안전하지 않음)]**을 클릭합니다. (본인이 직접 만든 코드라 안전합니다.)
5.  **[허용]**을 클릭합니다.

#### 3단계: 트리거(타이머) 설정
매일 아침 9시에 이 코드가 자동으로 실행되도록 설정합니다.

1.  Apps Script 화면 왼쪽 메뉴에서 **시계 모양 아이콘 (트리거)**을 클릭합니다.
2.  오른쪽 하단의 파란색 버튼 **[+ 트리거 추가]**를 클릭합니다.
3.  설정 창에서 아래와 같이 선택합니다:
    *   실행할 함수: `sendWelcomeSequence`
    *   배포: `Head` (그대로 둠)
    *   이벤트 소스: **[시간 기반]**
    *   트리거 유형: **[일 단위 타이머]**
    *   시간대: **[오전 9시 ~ 오전 10시]** (원하는 시간대 선택)
4.  **[저장]** 버튼을 누릅니다.

---

**🎉 이제 설정이 끝났습니다!**
오늘부터 신규 회원이 들어오면, 사장님이 주무시는 동안에도 이 시스템이 알아서 5일 동안 친절하게 인사를 건네고 구매를 유도할 것입니다.

**💡 팁:** 실제 고객에게 보내기 전에, 시트에 본인의 이메일과 오늘 날짜를 적고 테스트를 한 번 해보시는 것을 추천합니다!