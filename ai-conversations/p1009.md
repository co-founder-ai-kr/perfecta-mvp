# 민순의 요청

```text
* 역할: 너는 이메일 마케팅 전문가이자 앱스 스크립트 개발자야.
* 상황: 신규 회원이 가입했을 때 일일이 메일을 보낼 수가 없어. 잠자는 사이에도 자동으로 환영 인사를 하고 싶어.
* 과업: 
  1. 신규 가입자에게 5일 동안 발송할 '환영 이메일 시퀀스'의 주제와 핵심 내용을 표로 정리해 줘.
  2. 이에 맞게 자동 발송할 수 있도록 앱스 스크립트 코드를 짜 줘.
  3. 이 코드를 구글 시트의 어디에 붙여 넣어야 하는지, 그리고 매일 아침 9시에 자동으로 실행되게 하려면 '트리거(시계 아이콘)'를 어떻게 설정해야 하는지 단계별로 설명해 줘.
* 제약: 
  - 고객이 부담스럽지 않게 친근한 톤으로 설계해 줘.
  - 코드는 복사 가능한 형태로 출력해 줘.
* 입력: [이메일 발송 목적]
 (예시: 신규 가입 환영 및 첫 구매 유도)
```

# 제미나이의 응답

반갑습니다! 이메일 마케팅 전문가이자 앱스 스크립트 개발자로서, 당신의 비즈니스가 잠자는 사이에도 성장할 수 있도록 돕겠습니다.

요청하신 **[신규 가입 환영 및 첫 구매 유도]**를 목적으로 한 5일간의 이메일 시퀀스 전략과 이를 자동화하는 코드를 작성해 드립니다.

---

### 1. 5일간의 환영 이메일 시퀀스 전략 (친근한 톤)

고객이 가입 직후 가장 관심도가 높을 때, 부담을 주지 않으면서 자연스럽게 첫 구매로 이어지도록 설계했습니다.

| 발송 시점 | 주제 | 핵심 내용 및 목적 |
| :-- | :-- | :-- |
| **Day 1**<br>(가입 당일) | **환영 인사 & 깜짝 선물** | **[목적: 즉각적인 보상 및 관계 형성]**<br>- 가입 감사 인사 (친근하게)<br>- "빈손으로 오지 않았어요!"라며 첫 구매 할인 쿠폰 제공<br>- 브랜드의 핵심 가치 한 줄 소개 |
| **Day 2**<br>(가입 1일 후) | **브랜드 스토리 & 공감** | **[목적: 신뢰 구축]**<br>- 우리가 왜 이 서비스를 시작했는지 짧은 스토리텔링<br>- "저도 처음엔 이런 고민이 있었어요" 식의 공감대 형성<br>- 판매보다는 '우리는 당신 편'이라는 메시지 전달 |
| **Day 3**<br>(가입 2일 후) | **베스트 아이템 & 꿀팁** | **[목적: 탐색 유도]**<br>- 다른 고객들이 가장 사랑하는 Best 3 제품/서비스 소개<br>- 실패 없는 선택을 위한 팁 제공<br>- "이걸 써보면 생활이 이렇게 달라져요" (혜택 강조) |
| **Day 4**<br>(가입 3일 후) | **고객 후기 (Social Proof)** | **[목적: 구매 장벽 제거]**<br>- 실제 고객들의 생생한 후기 공유<br>- "저만 좋다고 하는 게 아니에요"<br>- 망설이는 이유(가격, 품질 등)를 해소해 주는 후기 선정 |
| **Day 5**<br>(가입 4일 후) | **쿠폰 마감 임박 알림** | **[목적: 긴급성 부여 및 구매 전환]**<br>- Day 1에 드린 혜택이 곧 사라짐을 알림 (부드럽게)<br>- "아까워서 챙겨드려요"<br>- 마지막으로 둘러볼 수 있는 링크 제공 |

---

### 2. 구글 시트 준비 사항

코드를 적용하기 전에 구글 시트가 아래와 같은 형식으로 되어 있어야 합니다.
*   **시트 이름:** `회원목록` (아래 탭 이름을 더블클릭해서 수정하세요)
*   **A열:** 이름
*   **B열:** 이메일 주소
*   **C열:** 가입일 (형식: 2023-10-27)

| | A | B | C |
|:---:|:---:|:---:|:---:|
| **1** | **이름** | **이메일** | **가입일** |
| 2 | 김철수 | chulsoo@example.com | 2023-10-27 |
| 3 | 이영희 | younghee@example.com | 2023-10-26 |

---

### 3. 앱스 스크립트 코드 (복사/붙여넣기용)

이 코드는 매일 실행되면서, 가입일로부터 며칠이 지났는지 계산하여 알맞은 이메일을 자동으로 발송합니다.

```javascript
function sendWelcomeSequence() {
  // 1. 시트 불러오기 (시트 이름을 '회원목록'으로 맞춰주세요)
  var sheet = SpreadsheetApp.getActiveSpreadsheet().getSheetByName("회원목록");
  
  // 데이터가 없으면 종료
  if (sheet.getLastRow() <= 1) return;

  var data = sheet.getRange(2, 1, sheet.getLastRow() - 1, 3).getValues(); // A2부터 데이터 가져오기
  var today = new Date();
  
  // 시간은 무시하고 날짜만 비교하기 위해 0시 0분 0초로 설정
  today.setHours(0, 0, 0, 0);

  // 2. 각 회원별로 반복문 실행
  for (var i = 0; i < data.length; i++) {
    var name = data[i][0];
    var email = data[i][1];
    var signupDate = new Date(data[i][2]);
    
    // 가입일 날짜 정규화
    signupDate.setHours(0, 0, 0, 0);

    // 가입일로부터 며칠 지났는지 계산 (밀리초 단위 계산 후 일 단위 변환)
    var diffTime = today.getTime() - signupDate.getTime();
    var daysPassed = Math.floor(diffTime / (1000 * 60 * 60 * 24));

    // 이메일 제목과 본문 변수 초기화
    var subject = "";
    var body = "";

    // 3. 날짜별 이메일 내용 설정 (HTML 형식 사용 가능)
    switch (daysPassed) {
      case 0: // Day 1: 가입 당일
        subject = `[환영합니다] ${name}님, 반가워요! (첫 구매 선물 도착 🎁)`;
        body = `안녕하세요, ${name}님!<br><br>저희와 함께 해주셔서 진심으로 감사합니다.<br>감사의 마음을 담아 <b>첫 구매 10% 할인 쿠폰</b>을 준비했어요.<br><br>코드: <b>WELCOME10</b><br><br>지금 바로 사용해보세요!`;
        break;

      case 1: // Day 2: 가입 1일 후
        subject = `${name}님, 저희 이야기를 들려드릴게요.`;
        body = `안녕하세요, ${name}님.<br><br>저희가 왜 이 서비스를 시작했는지 궁금하지 않으신가요?<br>사실 저도 처음에는... (브랜드 스토리 내용)<br><br>우리는 ${name}님의 고민을 해결해드리고 싶어요.`;
        break;

      case 2: // Day 3: 가입 2일 후
        subject = `실패 없는 선택! 베스트 아이템 3가지 🏆`;
        body = `${name}님, 무엇을 고를지 망설여지시나요?<br><br>다른 분들이 가장 많이 사랑해주신 <b>Best 3</b>를 소개합니다.<br>1. 아이템 A<br>2. 아이템 B<br>3. 아이템 C<br><br>후회 없는 선택이 될 거예요!`;
        break;

      case 3: // Day 4: 가입 3일 후
        subject = `👀 다른 분들은 이렇게 말해요 (솔직 후기)`;
        body = `${name}님, 아직 고민 중이신가요?<br><br>"처음엔 반신반의했는데, 써보니 정말 다르네요!"<br>- 실제 고객 김OO님의 후기<br><br>직접 경험해보신 분들의 이야기를 확인해보세요.`;
        break;

      case 4: // Day 5: 가입 4일 후
        subject = `[마감 임박] ${name}님, 쿠폰이 곧 사라져요! ⏰`;
        body = `안녕하세요, ${name}님.<br><br>가입 선물로 드린 할인 쿠폰이 곧 만료될 예정이에요.<br>아까운 혜택 놓치지 마시고, 지금 바로 확인해보세요!<br><br>👉 <a href="https://your-website.com">홈페이지 바로가기</a>`;
        break;
        
      default:
        // 해당 날짜가 아니면 아무것도 하지 않음
        continue;
    }

    // 4. 이메일 발송 실행
    if (email && subject && body) {
      try {
        MailApp.sendEmail({
          to: email,
          subject: subject,
          htmlBody: body
        });
        console.log(`${name}님에게 ${daysPassed}일차 메일 발송 성공`);
      } catch (e) {
        console.log(`${name}님 메일 발송 실패: ` + e.toString());
      }
    }
  }
}
```

---

### 4. 설치 및 자동 실행 설정 방법 (단계별 가이드)

이제 이 코드를 구글 시트에 심고, 매일 아침 9시에 저절로 돌아가게 설정해 봅시다.

#### **Step 1: 코드 붙여넣기**
1.  구글 시트 상단 메뉴에서 **[확장 프로그램]** > **[Apps Script]**를 클릭합니다.
2.  새 창이 열리면 기존에 있는 `function myFunction() {...}` 코드를 모두 지웁니다.
3.  위에서 제가 작성해 드린 **코드 전체를 복사해서 붙여넣습니다.**
4.  상단 디스켓 아이콘(💾)을 눌러 저장합니다. (프로젝트 이름은 '이메일 자동화' 등으로 지어주세요.)

#### **Step 2: 권한 승인 (최초 1회)**
1.  코드 입력창 상단의 `▷ 실행` 버튼을 누릅니다.
2.  **'권한 검토'** 창이 뜨면 클릭합니다.
3.  본인의 구글 계정을 선택합니다.
4.  *'Google에서 확인하지 않은 앱'*이라는 경고가 뜨면, 좌측 하단 **[고급]**을 누르고 **[이메일 자동화(으)로 이동(안전하지 않음)]**을 클릭합니다. (본인이 직접 만든 코드라 안전합니다.)
5.  **[허용]**을 클릭합니다.

#### **Step 3: 트리거(자동 실행) 설정**
매일 아침 9시에 이 코드가 작동하도록 알람을 맞추는 과정입니다.

1.  Apps Script 화면 왼쪽 메뉴에서 **시계 모양 아이콘 (트리거)**를 클릭합니다.
2.  오른쪽 하단의 파란색 버튼 **[+ 트리거 추가]**를 클릭합니다.
3.  설정 창에서 아래와 같이 선택합니다:
    *   실행할 함수: `sendWelcomeSequence`
    *   배포: `Head` (그대로 둠)
    *   이벤트 소스: **[시간 기반]**
    *   트리거 유형: **[일 단위 타이머]**
    *   시간대: **[오전 9시 ~ 10시]** (원하는 시간대로 설정 가능)
4.  **[저장]** 버튼을 누릅니다.

---

### ✅ 마무리 팁
*   **테스트:** 실제 고객에게 보내기 전에, 시트의 이메일 란에 **본인의 이메일**을 넣고 가입일을 오늘, 어제, 그저께 등으로 바꿔가며 `▷ 실행` 버튼을 눌러 메일이 잘 오는지 확인해 보세요.
*   **내용 수정:** 코드 중간에 있는 `subject`(제목)와 `body`(본문) 내용을 원하시는 문구로 자유롭게 수정하시면 됩니다. `<br>`은 줄바꿈을 의미합니다.

이제 푹 주무셔도 구글 시트가 알아서 신규 고객을 따뜻하게 맞이해 줄 거예요! 성공적인 마케팅 되시길 바랍니다.