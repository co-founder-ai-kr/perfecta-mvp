# 민순의 요청

```text
* 역할: 너는 친절한 앱스 스크립트 전문 개발자야.
* 상황: 구글 시트 데이터를 웹 사이트 화면에 띄우고 싶어.
* 과업:
  1. 시트 데이터를 JSON 형태로 변환하는 doGet 함수를 작성해 줘.
  2. 웹 사이트에서 에러 없이 데이터를 받으려면 반드시 `ContentService.createTextOutput`을 사용해서 JSON을 반환해야 해. 이 부분이 포함된 코드를 짜 줘.
  3. 코드 붙여넣기 위치와 배포 시 ‘액세스 권한’ 설정 방법을 알려 줘.
* 제약: 
  - 어려운 전문 용어는 배제해 줘.
  - 코드는 복사해서 바로 쓸 수 있게 작성해 줘.
* 출력: 
  1. 앱스 스크립트 코드
  2. 배포 설정 가이드
* 입력: [시트 이름 및 데이터 구조]
 (예시: 시트 이름은 'Products', A열은 상품명, B열은 가격)
```

# 제미나이의 응답

안녕하세요! 친절한 앱스 스크립트 개발자입니다. 😊

구글 시트의 데이터를 웹사이트에서 가져다 쓸 수 있도록 **JSON(데이터 교환 형식)**으로 변환해 주는 코드를 작성해 드릴게요. 요청하신 대로 `ContentService`를 사용하여 웹에서 에러 없이 데이터를 받아갈 수 있도록 만들었습니다.

아래 내용을 차근차근 따라와 주세요!

---

### 1. 앱스 스크립트 코드

이 코드는 시트의 첫 번째 줄(A1, B1...)을 **제목(Key)**으로, 그 아래 내용들을 **데이터(Value)**로 인식해서 자동으로 변환해 줍니다.

**사용 방법:**
1. 구글 시트 상단 메뉴에서 **[확장 프로그램]** > **[Apps Script]**를 클릭하세요.
2. 열리는 편집기 화면에 있는 기존 코드를 다 지우고, 아래 코드를 복사해서 붙여넣으세요.
3. **저장(💾 아이콘)**을 누르세요.

```javascript
function doGet() {
  // 1. 현재 열려있는 스프레드시트에서 'Products'라는 이름의 시트를 가져옵니다.
  // (만약 시트 이름이 다르면 'Products' 부분을 실제 시트 이름으로 바꿔주세요)
  var sheet = SpreadsheetApp.getActiveSpreadsheet().getSheetByName('Products');
  
  // 2. 시트에 있는 모든 데이터를 가져옵니다.
  var data = sheet.getDataRange().getValues();
  
  // 3. 첫 번째 줄은 '제목(Header)'으로 사용하고, 나머지는 실제 데이터입니다.
  var headers = data[0];
  var rows = data.slice(1);
  
  // 4. 데이터를 웹에서 쓰기 편한 형태(JSON)로 변환하는 과정입니다.
  var result = rows.map(function(row) {
    var obj = {};
    headers.forEach(function(header, index) {
      obj[header] = row[index];
    });
    return obj;
  });
  
  // 5. 변환된 데이터를 웹사이트로 내보냅니다. (이 부분이 가장 중요해요!)
  // JSON 문자열로 바꾸고, 인터넷 창에서 잘 보이도록 설정을 맞춰줍니다.
  return ContentService.createTextOutput(JSON.stringify(result))
    .setMimeType(ContentService.MimeType.JSON);
}
```

---

### 2. 배포 설정 가이드 (아주 중요! ⭐)

코드를 저장했다면, 이제 웹사이트에서 접속할 수 있는 **URL(주소)**을 만들어야 합니다. 이 과정에서 **권한 설정**을 잘못하면 데이터가 보이지 않으니 꼭 확인해 주세요.

1.  스크립트 편집기 오른쪽 상단의 **[배포]** 버튼을 누르고 **[새 배포]**를 선택하세요.
2.  '유형 선택' 옆의 톱니바퀴(⚙️)를 누르고 **[웹 앱]**을 선택하세요.
3.  설정 창이 나오면 아래와 같이 입력하세요:
    *   **설명:** (비워둬도 됩니다. 예: 상품 데이터 API)
    *   **다음 사용자 계정으로 실행:** `나(본인 이메일)` 그대로 두세요.
    *   **액세스 권한 승인:** **`모든 사용자` (반드시 이걸로 선택하세요!)**
        *   *주의: 'Google 계정을 가진 모든 사용자'가 아니라 그냥 '모든 사용자'여야 웹사이트에서 로그인 없이 데이터를 가져갈 수 있습니다.*
4.  **[배포]** 버튼을 클릭하세요.
5.  (처음이라면) '액세스 승인' 창이 뜹니다. **[권한 검토]** -> **[본인 계정 선택]** -> (경고창이 뜨면) **[고급]** -> **[...로 이동(안전하지 않음)]** -> **[허용]**을 순서대로 눌러주세요.
6.  마지막으로 나오는 **'웹 앱 URL'**을 복사하세요.

이제 복사한 **웹 앱 URL**로 접속해 보시면, 시트의 데이터가 글자(JSON) 형태로 화면에 뜨는 것을 확인하실 수 있습니다! 이 주소를 웹 개발에 사용하시면 됩니다.

성공적인 개발 되시길 응원합니다! 👍