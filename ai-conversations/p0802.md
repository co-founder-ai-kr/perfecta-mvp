# 민순의 요청

```text
* 역할: 너는 친절한 앱스 스크립트 전문 개발자야.
* 상황: 구글 시트 데이터를 웹 사이트 화면에 띄우고 싶어.
* 과업: 
  1. 시트 데이터를 웹 사이트가 읽을 수 있는 JSON 형태로 변환하는 doGet 함수 코드를 작성해 줘.
  2. 코드 붙여넣기 위치와 배포 시 ‘액세스 권한’ 설정 방법을 알려 줘.
* 제약: 
  - 어려운 전문 용어는 배제해 줘.
  - 코드는 복사해서 바로 쓸 수 있게 작성해 줘.
* 출력: 
  1. 앱스 스크립트 코드
  2. 배포 설정 가이드
* 입력: [시트 이름 및 데이터 구조]
 (예시: 시트 이름은 'Products', A열은 상품명, B열은 가격)
```

# 제미나이의 응답

안녕하세요! 구글 시트의 데이터를 웹사이트에서 사용할 수 있게 만들어주는 친절한 앱스 스크립트 개발자입니다. ^^

요청하신 대로 **'Products'** 시트의 데이터를 웹사이트가 이해할 수 있는 **JSON(제이슨)** 형식으로 바꿔주는 코드를 작성했습니다. 복잡한 설명은 빼고, 바로 복사해서 쓸 수 있도록 준비했으니 아래 순서대로 따라와 주세요!

---

### 1. 앱스 스크립트 코드

이 코드는 시트의 **첫 번째 줄(A1, B1...)을 제목(Key)**으로, 그 아래 내용들을 **데이터(Value)**로 묶어서 변환해 줍니다.

```javascript
function doGet() {
  // 1. 데이터를 가져올 시트의 이름을 적어주세요.
  // (예시로 'Products'라고 적어두었습니다. 시트 이름이 다르면 여기를 수정하세요.)
  var sheetName = 'Products'; 
  
  // 2. 현재 스프레드시트와 시트를 가져옵니다.
  var ss = SpreadsheetApp.getActiveSpreadsheet();
  var sheet = ss.getSheetByName(sheetName);
  
  // 3. 시트에 있는 모든 데이터를 가져옵니다.
  var data = sheet.getDataRange().getValues();
  
  // 4. 첫 번째 줄은 '제목(Header)', 나머지 줄은 '내용(Rows)'으로 나눕니다.
  var headers = data[0]; 
  var rows = data.slice(1);
  
  // 5. 데이터를 웹사이트가 읽기 좋은 형태(JSON)로 예쁘게 포장합니다.
  var result = rows.map(function(row) {
    var obj = {};
    headers.forEach(function(header, index) {
      obj[header] = row[index];
    });
    return obj;
  });
  
  // 6. 포장된 데이터를 웹으로 내보냅니다.
  return ContentService.createTextOutput(JSON.stringify(result))
    .setMimeType(ContentService.MimeType.JSON);
}
```

---

### 2. 코드 붙여넣기 및 배포 설정 가이드

이제 이 코드를 시트에 적용하고, 외부에서 접속할 수 있도록 문을 열어주는 과정입니다. **'액세스 권한'** 설정이 가장 중요하니 꼭 확인해 주세요!

#### **Step 1: 코드 붙여넣기**
1.  구글 시트 상단 메뉴에서 **[확장 프로그램]** 클릭 -> **[Apps Script]**를 선택하세요.
2.  새 창이 열리면 기존에 있던 코드(`function myFunction()...`)를 모두 지우세요.
3.  위에서 제가 작성해 드린 코드를 **복사해서 붙여넣기** 하세요.
4.  저장 아이콘(💾)을 누르거나 `Ctrl + S`를 눌러 저장합니다.

#### **Step 2: 배포하기 (웹 앱으로 만들기)**
1.  화면 오른쪽 상단의 파란색 **[배포]** 버튼 클릭 -> **[새 배포]**를 선택하세요.
2.  '유형 선택' 톱니바퀴 아이콘을 눌러 **[웹 앱]**을 선택합니다.
3.  설정 창이 나오면 아래와 같이 설정해 주세요. (중요! ⭐)
    *   **설명:** (비워둬도 됩니다. 예: 상품 데이터 API)
    *   **다음 사용자 권한으로 실행:** **'나(자신의 이메일)'** 로 설정하세요.
    *   **액세스 권한 승인:** **'모든 사용자' (Anyone)** 로 설정하세요.
        *   *주의: 이 부분을 '모든 사용자'로 해야 웹사이트에서 로그인 없이 데이터를 읽어갈 수 있습니다.*
4.  **[배포]** 버튼을 클릭합니다.

#### **Step 3: 권한 승인 및 주소 복사**
1.  처음 배포할 때는 **'액세스 승인'** 창이 뜹니다. 본인 구글 계정을 선택하고 **[허용]**을 눌러주세요.
    *   (혹시 '확인되지 않은 앱' 경고가 뜨면, '고급' -> '이동(안전하지 않음)'을 누르시면 됩니다. 본인이 만든 거라 안전합니다!)
2.  배포가 완료되면 **'웹 앱 URL'**이라는 긴 주소가 나옵니다.
3.  이 주소를 **복사**해 두세요. 이제 이 주소가 시트 데이터를 보여주는 웹사이트 주소가 됩니다.

---

이제 복사한 **웹 앱 URL**로 접속해 보시면, 시트에 있던 상품명과 가격 데이터가 글자(JSON) 형태로 화면에 뜨는 것을 보실 수 있을 거예요!

성공적으로 연동되길 응원합니다! 더 궁금한 점이 있다면 언제든 물어봐 주세요. 😊