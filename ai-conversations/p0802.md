# 민순의 요청

```text
* 역할: 너는 친절한 앱스 스크립트 전문 개발자야.
* 상황: 코딩을 모르는 1인 창업가가 구글 시트 데이터를 웹 사이트 화면에 띄우고 싶어 해.
* 과업: 
  1. 시트 데이터를 웹 사이트가 읽을 수 있는 JSON 형태로 변환하는 doGet 함수 코드를 작성해 줘.
  2. 코드 붙여넣기 위치와 배포 시 ‘액세스 권한’ 설정 방법을 알려 줘.
* 제약: 
  - 어려운 전문 용어는 배제해 줘.
  - 코드는 복사해서 바로 쓸 수 있게 작성해 줘.
* 출력: 
  1. 앱스 스크립트 코드
  2. 배포 설정 가이드
* 입력: [시트 이름 및 데이터 구조]
 (예시: 시트 이름은 'Products', A열은 상품명, B열은 가격)
```

# 제미나이의 응답

안녕하세요! 1인 창업가님, 정말 멋진 도전을 하고 계시네요. 코딩을 전혀 모르셔도 괜찮습니다. 구글 시트의 데이터를 웹사이트가 이해할 수 있는 언어(JSON)로 바꿔주는 '통역사' 같은 코드를 만들어 드릴게요.

아래 내용을 천천히 따라 하시면 금방 나만의 데이터 주소(API)를 만드실 수 있습니다!

---

### 1. 앱스 스크립트 코드 (복사해서 붙여넣으세요)

이 코드는 시트의 **첫 번째 줄(A1, B1...)을 제목**으로 인식하고, 그 아래 있는 데이터들을 자동으로 가져옵니다.

```javascript
function doGet() {
  // 1. 데이터를 가져올 시트의 이름을 적어주세요.
  // (예시로 주신 'Products'를 적어두었습니다.)
  var sheetName = 'Products'; 
  
  // 2. 현재 엑셀 파일과 시트를 찾아옵니다.
  var sheet = SpreadsheetApp.getActiveSpreadsheet().getSheetByName(sheetName);
  
  // 3. 시트에 있는 모든 데이터를 가져옵니다.
  var data = sheet.getDataRange().getValues();
  
  // 4. 데이터가 하나도 없으면 빈 목록을 반환합니다.
  if (data.length === 0) {
    return ContentService.createTextOutput(JSON.stringify([]))
      .setMimeType(ContentService.MimeType.JSON);
  }

  // 5. 첫 번째 줄은 '제목(Header)', 나머지는 '내용(Rows)'으로 나눕니다.
  var headers = data[0]; 
  var rows = data.slice(1); 
  
  // 6. 웹사이트가 읽기 편한 형태(JSON)로 변환합니다.
  var result = rows.map(function(row) {
    var obj = {};
    headers.forEach(function(header, index) {
      obj[header] = row[index];
    });
    return obj;
  });

  // 7. 변환된 데이터를 웹으로 내보냅니다.
  return ContentService.createTextOutput(JSON.stringify(result))
    .setMimeType(ContentService.MimeType.JSON);
}
```

---

### 2. 코드 붙여넣기 및 배포 설정 가이드

이제 이 코드를 구글 시트에 심고, 인터넷 주소(URL)를 만들어 보겠습니다.

#### [단계 1] 코드 붙여넣기
1.  구글 시트 상단 메뉴에서 **[확장 프로그램]** 클릭 -> **[Apps Script]**를 선택하세요.
2.  새 창이 열리면 기존에 써있는 코드(`function myFunction...`)를 싹 지우세요.
3.  위에서 제가 작성해 드린 **코드를 복사해서 그대로 붙여넣기** 하세요.
4.  저장 아이콘(💾)을 누르거나 `Ctrl + S`를 눌러 저장하세요. (프로젝트 이름은 아무거나 지으셔도 됩니다.)

#### [단계 2] 배포하기 (가장 중요!)
웹사이트에서 이 데이터를 가져가려면 **'배포'**라는 과정을 거쳐야 합니다.

1.  오른쪽 위 파란색 **[배포]** 버튼 클릭 -> **[새 배포]** 선택.
2.  '유형 선택' 옆의 톱니바퀴(⚙️) 클릭 -> **[웹 앱]** 선택.
3.  설정 창이 나오면 아래와 같이 설정해주세요. (이 부분이 틀리면 작동하지 않아요!)
    *   **설명:** (비워도 됨)
    *   **다음 사용자 권한으로 실행:** `나(Me)` (그대로 두세요)
    *   **액세스 권한 승인:** **`모든 사용자` (반드시 이걸로 바꿔주세요!)**
        *   *이유: 웹사이트 방문자는 구글 로그인을 안 한 상태일 수도 있기 때문에, 누구나 데이터를 볼 수 있게 열어주는 것입니다.*
4.  **[배포]** 버튼 클릭.
5.  처음이라면 **'액세스 승인'** 창이 뜹니다.
    *   [권한 검토] 클릭 -> 본인 구글 계정 선택 -> (경고창이 뜨면) 왼쪽 아래 **[고급]** 클릭 -> **[...로 이동(안전하지 않음)]** 클릭 -> **[허용]** 클릭.
    *   *안심하세요! 본인이 만든 코드라 안전합니다.*

#### [단계 3] 주소 복사
1.  배포가 완료되면 **'웹 앱 URL'**이라는 긴 주소가 나옵니다.
2.  **[복사]** 버튼을 누르세요.
3.  이 주소가 바로 창업가님의 웹사이트 개발에 사용할 **데이터 주소**입니다!

이제 이 주소를 인터넷 주소창에 붙여넣고 엔터를 쳐보세요. 시트에 있는 상품명과 가격 데이터가 글자 형태로 화면에 뜬다면 성공입니다! 🎉