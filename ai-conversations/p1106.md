# 민순의 요청

```text
* 역할: 너는 데이터 분석가야.
* 상황: 구글 시트에 쌓인 지난 한 달간의 상담 로그를 분석하여 인사이트를 얻고 싶어. 데이터 분석 지식이 전혀 없는 상태야.
* 과업:
  1. 부정적 뉘앙스가 담긴 대화를 추출하는 기준을 세워 줘.
  2. 데이터를 분석해 문제점 3가지를 요약하는 앱스 스크립트 논리를 설명해 줘.
* 제약: 코드를 직접 짜기보다 처리 논리를 단계별 목록(List) 형태로 알려 줘.
* 출력: 단계별 목록
```

# 제미나이의 응답

안녕하세요! 데이터 분석가로서, 데이터 분석 지식이 없으셔도 구글 시트와 앱스 스크립트(Apps Script)의 논리를 이해하고 활용하실 수 있도록 단계별로 정리해 드리겠습니다.

코드를 직접 짜는 대신, **"어떤 기준으로 데이터를 골라내고, 어떤 순서로 일을 시킬지"**에 대한 논리적 설계도입니다.

---

### 1. 부정적 뉘앙스가 담긴 대화 추출 기준 (Rule-based Logic)

상담 로그에서 고객의 불만을 감지하기 위해, 컴퓨터가 이해할 수 있는 구체적인 '신호'를 정의해야 합니다. 다음 4가지 기준을 복합적으로 적용하는 것이 좋습니다.

**A. 강력한 부정 키워드 (Direct Negative)**
*   고객이 명확하게 불만을 표출할 때 사용하는 단어들입니다.
*   **목록:** 환불, 취소, 신고, 소비자원, 고발, 팀장, 책임자, 매니저, 사과, 보상, 최악, 쓰레기, 사기

**B. 감정적 표현 및 문장 부호 (Emotional Markers)**
*   텍스트에서 느껴지는 다급함이나 화난 어조를 감지합니다.
*   **목록:**
    *   문장 부호 반복: `!!`, `??`, `?!` (예: 장난합니까??, 언제 오냐고요!!)
    *   부정 서술어: 안 돼요, 안 됨, 못 함, 짜증, 화남, 답답

**C. 반복 및 지연 표현 (Repetition & Delay)**
*   문제가 해결되지 않아 반복적으로 문의하거나 기다림에 지친 상황입니다.
*   **목록:** 벌써, 도대체, 몇 번째, 또, 다시, 아직도, 연락 없음, 무응답, 뺑뺑이

**D. 상담 메타 데이터 활용 (만약 데이터에 포함되어 있다면)**
*   대화 내용 외에 숫자로 된 지표를 활용합니다.
*   **기준:**
    *   상담 시간: 평균보다 현저히 긴 상담 (해결이 안 되어 길어짐)
    *   발화 횟수: 고객의 말풍선 개수가 상담원보다 압도적으로 많은 경우

---

### 2. 문제점 3가지를 요약하는 앱스 스크립트 처리 논리

앱스 스크립트가 마치 사람처럼 데이터를 읽고, 분류하고, 요약하는 과정을 5단계 논리로 구성했습니다. 이 논리는 **"부정적인 대화만 골라내서 -> AI에게 읽히고 -> 요약을 시킨다"**는 흐름입니다.

#### **단계 1: 데이터 읽어오기 (Data Loading)**
1.  현재 활성화된 구글 시트의 '상담 로그' 시트를 선택합니다.
2.  데이터가 있는 전체 범위(행과 열)를 인식하여 메모리에 가져옵니다.
3.  첫 번째 행(제목 행)은 제외하고, 실제 상담 내용이 담긴 2번째 행부터 끝까지 반복할 준비를 합니다.

#### **단계 2: 부정 데이터 필터링 (Filtering)**
1.  가져온 데이터를 한 줄씩(한 상담 건씩) 검사합니다.
2.  위에서 정의한 **[1. 부정적 뉘앙스 추출 기준]**에 해당하는 단어나 기호가 포함되어 있는지 확인합니다.
    *   *논리 예시: 만약 대화 내용에 "환불" OR "!!" OR "아직도"가 포함되어 있다면?*
3.  조건에 맞는(부정적인) 상담 로그만 따로 모아 '불만 리스트'라는 임시 저장소에 담습니다.
    *   *이 과정이 없으면 데이터가 너무 많아 분석이 불가능하므로, 핵심 데이터만 추리는 과정입니다.*

#### **단계 3: 텍스트 전처리 및 통합 (Preprocessing)**
1.  '불만 리스트'에 모인 상담 내용들을 하나의 긴 텍스트 덩어리로 합칩니다.
2.  이때, 분석에 불필요한 정보(날짜, 상담원 ID 등)는 제외하고, 오직 **'고객이 말한 내용(문의 내용)'** 위주로 텍스트를 구성합니다.
3.  데이터가 너무 많을 경우, 가장 최근 100건 또는 텍스트 길이 제한을 두어 자릅니다. (AI 분석 도구의 입력 한계를 고려)

#### **단계 4: AI를 활용한 분석 및 요약 (Intelligence Analysis)**
*이 부분은 스크립트가 직접 생각하는 것이 아니라, 외부의 똑똑한 뇌(ChatGPT API 등)에 데이터를 보내서 결과를 받아오는 논리입니다.*

1.  **프롬프트(명령어) 구성:** 스크립트가 AI에게 보낼 명령어를 작성합니다.
    *   *"다음은 고객들의 불만 상담 로그야. 이 내용을 분석해서 가장 빈번하고 심각한 문제점 3가지를 원인과 함께 요약해 줘."*
2.  **데이터 전송:** [단계 3]에서 합친 '불만 텍스트'와 위 '명령어'를 AI 모델(OpenAI API 또는 Gemini API)에 전송합니다.
3.  **결과 수신:** AI가 분석한 '3가지 핵심 문제점 요약 텍스트'를 받아옵니다.

#### **단계 5: 결과 리포팅 (Reporting)**
1.  AI로부터 받은 요약 결과를 구글 시트의 새로운 시트(예: '분석 결과') 또는 팝업창에 출력합니다.
2.  (선택 사항) 분석된 내용을 관리자 이메일로 자동 발송하도록 설정합니다.

---

**💡 분석가 팁:**
이 논리를 개발자나 챗GPT에게 전달하여 코드를 짜달라고 할 때, **"OpenAI API(또는 Gemini)를 연동해서 부정적인 로그만 요약해 주는 스크립트를 짜줘"**라고 요청하면 훨씬 정확한 결과를 얻으실 수 있습니다. 단순히 단어 개수만 세는 것보다 AI에게 요약을 시키는 것이 '인사이트'를 얻는 데 훨씬 유리합니다.