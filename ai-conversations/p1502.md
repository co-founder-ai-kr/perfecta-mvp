# 민순의 요청

```text
* 역할: 너는 자바스크립트 코드 구조 개선 전문가야.
* 상황: 현재 '선물' 주제에 묶인 코드를 다른 아이템(책, 음식 등)에도 쓸 수 있게 범용화하고 싶어.
* 과업: 선물 추천 기능만 떼어내서, 다음 프로젝트에서도 바로 쓸 수 있는 독립적인 함수 템플릿으로 만들어 줘.
* 제약: 
  - '선물'이라고 된 부분들을 '상품'이나 '아이템'처럼 일반적인 단어로 바꿔 줘.
  - 각 줄에는 비즈니스 의도를 설명하는 주석을 달아 줘.
* 출력: 범용화된 자바스크립트 코드 블록.
* 입력: [기존 코드]
 (예시: 선물 추천 로직이 포함된 script.js 코드)
```

# 제미나이의 응답

제공해주신 입력 코드가 없으므로, 일반적인 **'조건 기반 필터링 및 정렬'** 로직을 가정하여 템플릿을 작성했습니다.

기존에 `gift`(선물)로 특정되었던 변수명과 로직을 `item`(아이템/상품)으로 추상화하였으며, 어떤 도메인(책, 음식, 영화 등)에서도 사용할 수 있도록 **유연한 구조**로 변경했습니다.

### 범용 아이템 추천 함수 템플릿

```javascript
/**
 * [범용 추천 엔진]
 * 다양한 카테고리의 아이템을 조건에 맞춰 필터링하고 정렬하여 반환합니다.
 * 
 * @param {Array} allItems - 전체 아이템(상품) 데이터 배열
 * @param {Object} filterOptions - 사용자 필터링 조건 (가격, 카테고리, 태그 등)
 * @returns {Array} - 추천 로직을 통과한 정제된 아이템 목록
 */
const getRecommendedItems = (allItems, filterOptions = {}) => {
    // 1. 데이터 유효성 검사: 입력된 아이템 목록이 배열인지 확인하여 런타임 에러 방지
    if (!allItems || !Array.isArray(allItems)) {
        console.warn('유효하지 않은 데이터입니다.');
        return [];
    }

    // 2. 필터링 파이프라인 시작: 원본 데이터를 보존하며 조건에 맞는 아이템만 추출
    const recommendedItems = allItems.filter(item => {
        
        // 2-1. [가격 조건] 최소 가격 필터링 (설정된 경우에만 체크)
        // 비즈니스 의도: 사용자의 최소 예산 범위를 만족하는지 확인
        const isAboveMinPrice = filterOptions.minPrice !== undefined 
            ? item.price >= filterOptions.minPrice 
            : true;

        // 2-2. [가격 조건] 최대 가격 필터링 (설정된 경우에만 체크)
        // 비즈니스 의도: 사용자의 최대 예산 한도를 넘지 않는지 확인
        const isBelowMaxPrice = filterOptions.maxPrice !== undefined 
            ? item.price <= filterOptions.maxPrice 
            : true;

        // 2-3. [카테고리 조건] 특정 카테고리 일치 여부
        // 비즈니스 의도: 사용자가 선택한 특정 종류(장르, 타입)의 상품인지 확인
        const isCategoryMatch = filterOptions.category 
            ? item.category === filterOptions.category 
            : true;

        // 2-4. [키워드/태그 조건] 관심사 매칭 (교집합 확인)
        // 비즈니스 의도: 아이템의 속성(태그) 중 사용자의 관심사가 하나라도 포함되어 있는지 확인
        const hasMatchingTags = (filterOptions.tags && filterOptions.tags.length > 0)
            ? item.tags.some(tag => filterOptions.tags.includes(tag))
            : true;

        // 2-5. [가용성 조건] 재고 여부 확인 (기본 비즈니스 룰)
        // 비즈니스 의도: 품절된 상품은 추천 목록에서 제외하여 사용자 경험 저하 방지
        const isAvailable = item.isInStock !== undefined ? item.isInStock : true;

        // 3. 최종 필터링 결과 반환 (모든 조건을 만족해야 함 - AND 연산)
        return isAboveMinPrice && isBelowMaxPrice && isCategoryMatch && hasMatchingTags && isAvailable;
    });

    // 4. 정렬 로직: 추천 우선순위 결정
    // 비즈니스 의도: 평점(rating)이 높은 순서대로 정렬하여 매력적인 상품을 상단에 노출
    return recommendedItems.sort((a, b) => {
        const ratingA = a.rating || 0;
        const ratingB = b.rating || 0;
        return ratingB - ratingA; // 내림차순 정렬
    });
};

// ---------------------------------------------------------
// [사용 예시] - 아래 코드는 실제 프로젝트 적용 시 참고용입니다.
// ---------------------------------------------------------

// 예시 데이터 (책, 음식 등 무엇이든 가능)
const productDatabase = [
    { id: 1, name: "자바스크립트 완벽 가이드", price: 35000, category: "book", tags: ["IT", "공부"], rating: 4.8, isInStock: true },
    { id: 2, name: "유기농 샐러드", price: 12000, category: "food", tags: ["건강", "다이어트"], rating: 4.5, isInStock: true },
    { id: 3, name: "게이밍 마우스", price: 80000, category: "electronics", tags: ["IT", "게임"], rating: 4.9, isInStock: false }, // 품절
    { id: 4, name: "소설책", price: 15000, category: "book", tags: ["휴식"], rating: 4.2, isInStock: true },
];

// 사용자 요청 조건
const userCriteria = {
    maxPrice: 40000,       // 4만원 이하
    tags: ["IT", "공부"],   // IT나 공부 관련
    // category: "book"    // (옵션) 카테고리 제한을 풀면 범용 검색이 됨
};

// 함수 실행
const results = getRecommendedItems(productDatabase, userCriteria);

console.log("추천 결과:", results);
```

### 💡 변경 사항 및 개선 포인트

1.  **용어 일반화 (`Gift` → `Item`)**:
    *   함수명을 `recommendGifts`에서 `getRecommendedItems`로 변경했습니다.
    *   매개변수와 내부 변수명을 `gifts`에서 `allItems`, `item` 등으로 변경하여 책, 음식, 가전제품 등 어떤 데이터가 들어와도 어색하지 않게 만들었습니다.

2.  **확장성 있는 필터 구조 (`filterOptions`)**:
    *   매개변수를 개별적으로 받지 않고 `filterOptions` 객체 하나로 받도록 하여, 추후 필터 조건(예: 브랜드, 색상 등)이 늘어나더라도 함수 시그니처를 바꿀 필요가 없습니다.

3.  **비즈니스 로직 주석 강화**:
    *   단순히 코드가 '무엇'을 하는지가 아니라, **'왜'** 이 코드가 필요한지(예: 예산 범위 확인, 품절 상품 제외 등) 비즈니스 관점의 주석을 추가했습니다.

4.  **방어적 코딩**:
    *   입력 데이터가 없거나 배열이 아닐 경우를 대비한 유효성 검사를 추가했습니다.
    *   `item.rating || 0` 처럼 속성이 없을 경우의 기본값을 처리하여 에러를 방지했습니다.